

---

### 🧩 \[TRD 상세] 하이브리드 유출 탐지 시스템 (Hybrid Leak Detection)

#### ✅ 목적

사용자의 정형 개인정보가 과거에 유출되었는지와 현재 외부 웹에 노출되고 있는지를 동시에 탐지하여 보안 상태를 진단하고, 빠른 조치로 연결되도록 함.

---

#### 🔹 A. 정적 유출 DB 탐지 모듈

| 항목    | 내용                                                                |
| ----- | ----------------------------------------------------------------- |
| 탐지 대상 | 이메일, 이름, 전화번호, 생년월일, 비밀번호 패턴 등                                    |
| 탐지 소스 | RockYou2021, Collection#1\~5, BreachCompilation 등 공개 유출 덤프 사전 인덱싱 |
| 탐색 방식 | Trie/Set 기반 정적 검색 + 비밀번호 패턴은 Levenshtein distance 유사도 탐색          |
| 응답 시간 | 1건당 평균 50\~150ms                                                  |
| 보안 처리 | 탐지 대상 해시화 후 내부 검색 (SHA256)                                        |
| 특징    | 오프라인 탐색이므로 속도 빠르고 비용 적음                                           |

---

#### 🔹 B. 실시간 외부 유출 탐지 (OSINT 크롤러)

| 항목     | 내용                                                  |
| ------ | --------------------------------------------------- |
| 탐지 대상  | 웹 포럼, 블로그, 커뮤니티, 뉴스 댓글, SNS 등                       |
| 주요 키워드 | 사용자 입력값 기반 이메일/전화번호/이름 조합                           |
| 구현 방식  | Scrapy + BeautifulSoup 기반 크롤러 모듈화 (도메인별 HTML 구조 대응) |
| 탐지 주기  | 사용자 요청 시 즉시 탐색 + 백그라운드 24시간 자동 모니터링                 |
| 결과 처리  | 수집된 문장은 Gemini API에 전송되어 유출 여부 판단                   |
| 다크웹 확장 | TOR 네트워크 접근은 추후 DarkOwl 또는 IntelX API 연동 예정         |

---

#### 🔹 C. Gemini 기반 AI 판단 및 리포트 생성

| 항목      | 내용                                     |
| ------- | -------------------------------------- |
| 모델      | Gemini 2.0 flash API (Google Cloud)      |
| 입력      | 탐지 문장 + 탐지 대상 정보 (Prompt)              |
| 출력      | 유출 여부 (bool) + 위험도 점수 + 리포트용 설명 문장     |
| 프롬프트 예시 | “다음 문장에서 개인 정보 유출 여부를 판단해줘: ...”       |
| 후처리     | 유출로 판단된 항목은 '증거 카드'로 시각화되고 미제 사건함에 기록됨 |

---

#### 🔹 통합 처리 흐름

```
[사용자 입력값 등록]
        ↓
[정적 유출 DB 탐지 모듈]
        ↓             ↘
[탐지 결과]         [OSINT 크롤링 모듈 실행]
        ↓                     ↓
     [Gemini API 판단 → 유출 여부 확인]
                     ↓
        [증거 카드 생성 + 미제 사건 보관 + 사용자 알림]
```

---

#### 🔹 성능 및 요구조건

| 항목           | 기준                             |
| ------------ | ------------------------------ |
| 정적 DB 탐색 응답  | 1건당 150ms 이하                   |
| OSINT 크롤링 속도 | 평균 탐색 완료 5\~10초                |
| Gemini 응답 지연 | 최대 2초 (로컬 캐시 처리 포함)            |
| 알림 응답성       | 위험도 80% 이상 시 즉시 앱 푸시 알림 전송     |
| 스케일링         | 사용자당 비동기 큐 처리 (Celery + Redis) |

---
